<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Sandbox
  
    &mdash; Homebrew Ruby API
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Sandbox";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (S)</a> &raquo;
    
    
    <span class="title">Sandbox</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Sandbox
  
  
  <span class="private note title">Private</span>
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">Sandbox</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>extend/os/mac/sandbox.rb<span class="defines">,<br />
  sandbox.rb</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This class is part of a private API.</strong>
  This class may only be used in the <a href="https://github.com/Homebrew/brew">Homebrew/brew</a> repository.
  Third parties should avoid using this class if possible, as it may be removed or changed without warning.
</p>
<p>Helper class for running a sub-process inside of a sandboxed environment.</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#available%3F-class_method" title="available? (class method)">.<strong>available?</strong>  &#x21d2; Boolean </a>
    
    
  </span>
  
  
  
  
  
  
  
  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#add_rule-instance_method" title="#add_rule (instance method)">#<strong>add_rule</strong>(rule)  &#x21d2; Object </a>
    
    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>
  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#allow_cvs-instance_method" title="#allow_cvs (instance method)">#<strong>allow_cvs</strong>  &#x21d2; Object </a>
    
    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>
  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#allow_fossil-instance_method" title="#allow_fossil (instance method)">#<strong>allow_fossil</strong>  &#x21d2; Object </a>
    
    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>
  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#allow_write-instance_method" title="#allow_write (instance method)">#<strong>allow_write</strong>(path, options = {})  &#x21d2; Object </a>
    
    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>
  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#allow_write_cellar-instance_method" title="#allow_write_cellar (instance method)">#<strong>allow_write_cellar</strong>(formula)  &#x21d2; Object </a>
    
    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>
  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#allow_write_log-instance_method" title="#allow_write_log (instance method)">#<strong>allow_write_log</strong>(formula)  &#x21d2; Object </a>
    
    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>
  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#allow_write_path-instance_method" title="#allow_write_path (instance method)">#<strong>allow_write_path</strong>(path)  &#x21d2; Object </a>
    
    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>
  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#allow_write_temp_and_cache-instance_method" title="#allow_write_temp_and_cache (instance method)">#<strong>allow_write_temp_and_cache</strong>  &#x21d2; Object </a>
    
    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>
  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#allow_write_xcode-instance_method" title="#allow_write_xcode (instance method)">#<strong>allow_write_xcode</strong>  &#x21d2; Object </a>
    
    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>
  
    <span class="summary_desc"><div class='inline'><p>Xcode projects expect access to certain cache/archive dirs.</p>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#deny_write-instance_method" title="#deny_write (instance method)">#<strong>deny_write</strong>(path, options = {})  &#x21d2; Object </a>
    
    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>
  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#deny_write_homebrew_repository-instance_method" title="#deny_write_homebrew_repository (instance method)">#<strong>deny_write_homebrew_repository</strong>  &#x21d2; Object </a>
    
    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>
  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#deny_write_path-instance_method" title="#deny_write_path (instance method)">#<strong>deny_write_path</strong>(path)  &#x21d2; Object </a>
    
    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>
  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#exec-instance_method" title="#exec (instance method)">#<strong>exec</strong>(*args)  &#x21d2; Object </a>
    
    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>
  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>  &#x21d2; void </a>
    
    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  <span class="private note title">private</span>
  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#record_log-instance_method" title="#record_log (instance method)">#<strong>record_log</strong>(file)  &#x21d2; Object </a>
    
    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>
  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  This method may only be used in the <a href="https://github.com/Homebrew/brew">Homebrew/brew</a> repository.
  Third parties should avoid using this method if possible, as it may be removed or changed without warning.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


22
23
24</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sandbox.rb', line 22</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
  <span class='ivar'>@profile</span> <span class='op'>=</span> <span class='const'>SandboxProfile</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="available?-class_method">
  
    .<strong>available?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


6
7
8</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'extend/os/mac/sandbox.rb', line 6</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_available?'>available?</span>
  <span class='const'><span class='object_link'><a href="File.html" title="File (class)">File</a></span></span><span class='period'>.</span><span class='id identifier rubyid_executable?'>executable?</span><span class='lparen'>(</span><span class='const'>SANDBOX_EXEC</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_rule-instance_method">
  
    #<strong>add_rule</strong>(rule)  &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  This method may only be used in the <a href="https://github.com/Homebrew/brew">Homebrew/brew</a> repository.
  Third parties should avoid using this method if possible, as it may be removed or changed without warning.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


30
31
32</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sandbox.rb', line 30</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_rule'>add_rule</span><span class='lparen'>(</span><span class='id identifier rubyid_rule'>rule</span><span class='rparen'>)</span>
  <span class='ivar'>@profile</span><span class='period'>.</span><span class='id identifier rubyid_add_rule'>add_rule</span><span class='lparen'>(</span><span class='id identifier rubyid_rule'>rule</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="allow_cvs-instance_method">
  
    #<strong>allow_cvs</strong>  &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  This method may only be used in the <a href="https://github.com/Homebrew/brew">Homebrew/brew</a> repository.
  Third parties should avoid using this method if possible, as it may be removed or changed without warning.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sandbox.rb', line 59</span>

<span class='kw'>def</span> <span class='id identifier rubyid_allow_cvs'>allow_cvs</span>
  <span class='id identifier rubyid_allow_write_path'>allow_write_path</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_home'>home</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="ENV.html" title="ENV (class)">ENV</a></span></span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>USER</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>/.cvspass</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="allow_fossil-instance_method">
  
    #<strong>allow_fossil</strong>  &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  This method may only be used in the <a href="https://github.com/Homebrew/brew">Homebrew/brew</a> repository.
  Third parties should avoid using this method if possible, as it may be removed or changed without warning.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


63
64
65
66</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sandbox.rb', line 63</span>

<span class='kw'>def</span> <span class='id identifier rubyid_allow_fossil'>allow_fossil</span>
  <span class='id identifier rubyid_allow_write_path'>allow_write_path</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_home'>home</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="ENV.html" title="ENV (class)">ENV</a></span></span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>USER</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>/.fossil</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_allow_write_path'>allow_write_path</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_home'>home</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="ENV.html" title="ENV (class)">ENV</a></span></span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>USER</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>/.fossil-journal</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="allow_write-instance_method">
  
    #<strong>allow_write</strong>(path, options = {})  &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  This method may only be used in the <a href="https://github.com/Homebrew/brew">Homebrew/brew</a> repository.
  Third parties should avoid using this method if possible, as it may be removed or changed without warning.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


34
35
36
37</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sandbox.rb', line 34</span>

<span class='kw'>def</span> <span class='id identifier rubyid_allow_write'>allow_write</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_add_rule'>add_rule</span> <span class='label'>allow:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>operation:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>file-write*</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>filter:</span> <span class='id identifier rubyid_path_filter'>path_filter</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_add_rule'>add_rule</span> <span class='label'>allow:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>operation:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>file-write-setugid</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>filter:</span> <span class='id identifier rubyid_path_filter'>path_filter</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="allow_write_cellar-instance_method">
  
    #<strong>allow_write_cellar</strong>(formula)  &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  This method may only be used in the <a href="https://github.com/Homebrew/brew">Homebrew/brew</a> repository.
  Third parties should avoid using this method if possible, as it may be removed or changed without warning.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


68
69
70
71
72</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sandbox.rb', line 68</span>

<span class='kw'>def</span> <span class='id identifier rubyid_allow_write_cellar'>allow_write_cellar</span><span class='lparen'>(</span><span class='id identifier rubyid_formula'>formula</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_allow_write_path'>allow_write_path</span> <span class='id identifier rubyid_formula'>formula</span><span class='period'>.</span><span class='id identifier rubyid_rack'>rack</span>
  <span class='id identifier rubyid_allow_write_path'>allow_write_path</span> <span class='id identifier rubyid_formula'>formula</span><span class='period'>.</span><span class='id identifier rubyid_etc'>etc</span>
  <span class='id identifier rubyid_allow_write_path'>allow_write_path</span> <span class='id identifier rubyid_formula'>formula</span><span class='period'>.</span><span class='id identifier rubyid_var'>var</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="allow_write_log-instance_method">
  
    #<strong>allow_write_log</strong>(formula)  &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  This method may only be used in the <a href="https://github.com/Homebrew/brew">Homebrew/brew</a> repository.
  Third parties should avoid using this method if possible, as it may be removed or changed without warning.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


80
81
82</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sandbox.rb', line 80</span>

<span class='kw'>def</span> <span class='id identifier rubyid_allow_write_log'>allow_write_log</span><span class='lparen'>(</span><span class='id identifier rubyid_formula'>formula</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_allow_write_path'>allow_write_path</span> <span class='id identifier rubyid_formula'>formula</span><span class='period'>.</span><span class='id identifier rubyid_logs'>logs</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="allow_write_path-instance_method">
  
    #<strong>allow_write_path</strong>(path)  &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  This method may only be used in the <a href="https://github.com/Homebrew/brew">Homebrew/brew</a> repository.
  Third parties should avoid using this method if possible, as it may be removed or changed without warning.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


43
44
45</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sandbox.rb', line 43</span>

<span class='kw'>def</span> <span class='id identifier rubyid_allow_write_path'>allow_write_path</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_allow_write'>allow_write</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:subpath</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="allow_write_temp_and_cache-instance_method">
  
    #<strong>allow_write_temp_and_cache</strong>  &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  This method may only be used in the <a href="https://github.com/Homebrew/brew">Homebrew/brew</a> repository.
  Third parties should avoid using this method if possible, as it may be removed or changed without warning.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


51
52
53
54
55
56
57</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sandbox.rb', line 51</span>

<span class='kw'>def</span> <span class='id identifier rubyid_allow_write_temp_and_cache'>allow_write_temp_and_cache</span>
  <span class='id identifier rubyid_allow_write_path'>allow_write_path</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/private/tmp</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_allow_write_path'>allow_write_path</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/private/var/tmp</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_allow_write'>allow_write</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>^/private/var/folders/[^/]+/[^/]+/[C,T]/</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:regex</span>
  <span class='id identifier rubyid_allow_write_path'>allow_write_path</span> <span class='const'><span class='object_link'><a href="top-level-namespace.html#HOMEBREW_TEMP-constant" title="HOMEBREW_TEMP (constant)">HOMEBREW_TEMP</a></span></span>
  <span class='id identifier rubyid_allow_write_path'>allow_write_path</span> <span class='const'><span class='object_link'><a href="top-level-namespace.html#HOMEBREW_CACHE-constant" title="HOMEBREW_CACHE (constant)">HOMEBREW_CACHE</a></span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="allow_write_xcode-instance_method">
  
    #<strong>allow_write_xcode</strong>  &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  This method may only be used in the <a href="https://github.com/Homebrew/brew">Homebrew/brew</a> repository.
  Third parties should avoid using this method if possible, as it may be removed or changed without warning.
</p>
<p>Xcode projects expect access to certain cache/archive dirs.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


75
76
77
78</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sandbox.rb', line 75</span>

<span class='kw'>def</span> <span class='id identifier rubyid_allow_write_xcode'>allow_write_xcode</span>
  <span class='id identifier rubyid_allow_write_path'>allow_write_path</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_home'>home</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="ENV.html" title="ENV (class)">ENV</a></span></span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>USER</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>/Library/Developer</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_allow_write_path'>allow_write_path</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_home'>home</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="ENV.html" title="ENV (class)">ENV</a></span></span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>USER</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>/Library/Caches/org.swift.swiftpm</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="deny_write-instance_method">
  
    #<strong>deny_write</strong>(path, options = {})  &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  This method may only be used in the <a href="https://github.com/Homebrew/brew">Homebrew/brew</a> repository.
  Third parties should avoid using this method if possible, as it may be removed or changed without warning.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


39
40
41</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sandbox.rb', line 39</span>

<span class='kw'>def</span> <span class='id identifier rubyid_deny_write'>deny_write</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_add_rule'>add_rule</span> <span class='label'>allow:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>operation:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>file-write*</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>filter:</span> <span class='id identifier rubyid_path_filter'>path_filter</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="deny_write_homebrew_repository-instance_method">
  
    #<strong>deny_write_homebrew_repository</strong>  &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  This method may only be used in the <a href="https://github.com/Homebrew/brew">Homebrew/brew</a> repository.
  Third parties should avoid using this method if possible, as it may be removed or changed without warning.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


84
85
86
87
88
89
90
91
92</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sandbox.rb', line 84</span>

<span class='kw'>def</span> <span class='id identifier rubyid_deny_write_homebrew_repository'>deny_write_homebrew_repository</span>
  <span class='id identifier rubyid_deny_write'>deny_write</span> <span class='const'><span class='object_link'><a href="top-level-namespace.html#HOMEBREW_BREW_FILE-constant" title="HOMEBREW_BREW_FILE (constant)">HOMEBREW_BREW_FILE</a></span></span>
  <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="top-level-namespace.html#HOMEBREW_PREFIX-constant" title="HOMEBREW_PREFIX (constant)">HOMEBREW_PREFIX</a></span></span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="top-level-namespace.html#HOMEBREW_REPOSITORY-constant" title="HOMEBREW_REPOSITORY (constant)">HOMEBREW_REPOSITORY</a></span></span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
    <span class='id identifier rubyid_deny_write_path'>deny_write_path</span> <span class='const'><span class='object_link'><a href="top-level-namespace.html#HOMEBREW_LIBRARY-constant" title="HOMEBREW_LIBRARY (constant)">HOMEBREW_LIBRARY</a></span></span>
    <span class='id identifier rubyid_deny_write_path'>deny_write_path</span> <span class='const'><span class='object_link'><a href="top-level-namespace.html#HOMEBREW_REPOSITORY-constant" title="HOMEBREW_REPOSITORY (constant)">HOMEBREW_REPOSITORY</a></span></span><span class='op'>/</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.git</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_deny_write_path'>deny_write_path</span> <span class='const'><span class='object_link'><a href="top-level-namespace.html#HOMEBREW_REPOSITORY-constant" title="HOMEBREW_REPOSITORY (constant)">HOMEBREW_REPOSITORY</a></span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="deny_write_path-instance_method">
  
    #<strong>deny_write_path</strong>(path)  &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  This method may only be used in the <a href="https://github.com/Homebrew/brew">Homebrew/brew</a> repository.
  Third parties should avoid using this method if possible, as it may be removed or changed without warning.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


47
48
49</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sandbox.rb', line 47</span>

<span class='kw'>def</span> <span class='id identifier rubyid_deny_write_path'>deny_write_path</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_deny_write'>deny_write</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:subpath</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="exec-instance_method">
  
    #<strong>exec</strong>(*args)  &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  This method may only be used in the <a href="https://github.com/Homebrew/brew">Homebrew/brew</a> repository.
  Third parties should avoid using this method if possible, as it may be removed or changed without warning.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sandbox.rb', line 94</span>

<span class='kw'>def</span> <span class='id identifier rubyid_exec'>exec</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_seatbelt'>seatbelt</span> <span class='op'>=</span> <span class='const'>Tempfile</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>homebrew</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.sb</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="top-level-namespace.html#HOMEBREW_TEMP-constant" title="HOMEBREW_TEMP (constant)">HOMEBREW_TEMP</a></span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_seatbelt'>seatbelt</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='ivar'>@profile</span><span class='period'>.</span><span class='id identifier rubyid_dump'>dump</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_seatbelt'>seatbelt</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
  <span class='ivar'>@start</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Time.html" title="Time (class)">Time</a></span></span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>

  <span class='kw'>begin</span>
    <span class='id identifier rubyid_command'>command</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='const'>SANDBOX_EXEC</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-f</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_seatbelt'>seatbelt</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rbracket'>]</span>
    <span class='comment'># Start sandbox in a pseudoterminal to prevent access of the parent terminal.
</span>    <span class='const'>PTY</span><span class='period'>.</span><span class='id identifier rubyid_spawn'>spawn</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_command'>command</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_r'>r</span><span class='comma'>,</span> <span class='id identifier rubyid_w'>w</span><span class='comma'>,</span> <span class='id identifier rubyid_pid'>pid</span><span class='op'>|</span>
      <span class='comment'># Set the PTY&#39;s window size to match the parent terminal.
</span>      <span class='comment'># Some formula tests are sensitive to the terminal size and fail if this is not set.
</span>      <span class='id identifier rubyid_winch'>winch</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__sig'>_sig</span><span class='op'>|</span>
        <span class='id identifier rubyid_w'>w</span><span class='period'>.</span><span class='id identifier rubyid_winsize'>winsize</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='gvar'>$stdout</span><span class='period'>.</span><span class='id identifier rubyid_tty?'>tty?</span>
          <span class='comment'># We can only use IO#winsize if the IO object is a TTY.
</span>          <span class='gvar'>$stdout</span><span class='period'>.</span><span class='id identifier rubyid_winsize'>winsize</span>
        <span class='kw'>else</span>
          <span class='comment'># Otherwise, default to tput, if available.
</span>          <span class='comment'># This relies on ncurses rather than the system&#39;s ioctl.
</span>          <span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="Utils.html" title="Utils (module)">Utils</a></span></span><span class='period'>.</span><span class='id identifier rubyid_popen_read'><span class='object_link'><a href="Utils.html#popen_read-class_method" title="Utils.popen_read (method)">popen_read</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tput</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>lines</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="Utils.html" title="Utils (module)">Utils</a></span></span><span class='period'>.</span><span class='id identifier rubyid_popen_read'><span class='object_link'><a href="Utils.html#popen_read-class_method" title="Utils.popen_read (method)">popen_read</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tput</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cols</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_write_to_pty'>write_to_pty</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> <span class='kw'>do</span>
        <span class='comment'># Don&#39;t hang if stdin is not able to be used - throw EIO instead.
</span>        <span class='id identifier rubyid_old_ttin'>old_ttin</span> <span class='op'>=</span> <span class='id identifier rubyid_trap'>trap</span><span class='lparen'>(</span><span class='symbol'>:TTIN</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>IGNORE</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

        <span class='comment'># Update the window size whenever the parent terminal&#39;s window size changes.
</span>        <span class='id identifier rubyid_old_winch'>old_winch</span> <span class='op'>=</span> <span class='id identifier rubyid_trap'>trap</span><span class='lparen'>(</span><span class='symbol'>:WINCH</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_winch'>winch</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_winch'>winch</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='rparen'>)</span>

        <span class='id identifier rubyid_stdin_thread'>stdin_thread</span> <span class='op'>=</span> <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>do</span>
          <span class='const'><span class='object_link'><a href="IO.html" title="IO (class)">IO</a></span></span><span class='period'>.</span><span class='id identifier rubyid_copy_stream'>copy_stream</span><span class='lparen'>(</span><span class='gvar'>$stdin</span><span class='comma'>,</span> <span class='id identifier rubyid_w'>w</span><span class='rparen'>)</span>
        <span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>EIO</span>
          <span class='comment'># stdin is unavailable - move on.
</span>        <span class='kw'>end</span>

        <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_each_char'>each_char</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_print'>print</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

        <span class='const'>Process</span><span class='period'>.</span><span class='id identifier rubyid_wait'>wait</span><span class='lparen'>(</span><span class='id identifier rubyid_pid'>pid</span><span class='rparen'>)</span>
      <span class='kw'>ensure</span>
        <span class='id identifier rubyid_stdin_thread'>stdin_thread</span><span class='op'>&amp;.</span><span class='id identifier rubyid_kill'>kill</span>
        <span class='id identifier rubyid_trap'>trap</span><span class='lparen'>(</span><span class='symbol'>:TTIN</span><span class='comma'>,</span> <span class='id identifier rubyid_old_ttin'>old_ttin</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_trap'>trap</span><span class='lparen'>(</span><span class='symbol'>:WINCH</span><span class='comma'>,</span> <span class='id identifier rubyid_old_winch'>old_winch</span><span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='kw'>if</span> <span class='gvar'>$stdin</span><span class='period'>.</span><span class='id identifier rubyid_tty?'>tty?</span>
        <span class='comment'># If stdin is a TTY, use io.raw to set stdin to a raw, passthrough
</span>        <span class='comment'># mode while we copy the input/output of the process spawned in the
</span>        <span class='comment'># PTY. After we&#39;ve finished copying to/from the PTY process, io.raw
</span>        <span class='comment'># will restore the stdin TTY to its original state.
</span>        <span class='kw'>begin</span>
          <span class='comment'># Ignore SIGTTOU as setting raw mode will hang if the process is in the background.
</span>          <span class='id identifier rubyid_old_ttou'>old_ttou</span> <span class='op'>=</span> <span class='id identifier rubyid_trap'>trap</span><span class='lparen'>(</span><span class='symbol'>:TTOU</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>IGNORE</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
          <span class='gvar'>$stdin</span><span class='period'>.</span><span class='id identifier rubyid_raw'>raw</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_write_to_pty'>write_to_pty</span><span class='rparen'>)</span>
        <span class='kw'>ensure</span>
          <span class='id identifier rubyid_trap'>trap</span><span class='lparen'>(</span><span class='symbol'>:TTOU</span><span class='comma'>,</span> <span class='id identifier rubyid_old_ttou'>old_ttou</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_write_to_pty'>write_to_pty</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="ErrorDuringExecution.html" title="ErrorDuringExecution (class)">ErrorDuringExecution</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="ErrorDuringExecution.html#initialize-instance_method" title="ErrorDuringExecution#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_command'>command</span><span class='comma'>,</span> <span class='label'>status:</span> <span class='gvar'>$CHILD_STATUS</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='gvar'>$CHILD_STATUS</span><span class='period'>.</span><span class='id identifier rubyid_success?'>success?</span>
  <span class='kw'>rescue</span>
    <span class='ivar'>@failed</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_raise'>raise</span>
  <span class='kw'>ensure</span>
    <span class='id identifier rubyid_seatbelt'>seatbelt</span><span class='period'>.</span><span class='id identifier rubyid_unlink'>unlink</span>
    <span class='id identifier rubyid_sleep'>sleep</span> <span class='float'>0.1</span> <span class='comment'># wait for a bit to let syslog catch up the latest events.
</span>    <span class='id identifier rubyid_syslog_args'>syslog_args</span> <span class='op'>=</span> <span class='lbracket'>[</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-F</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$((Time)(local)) $(Sender)[$(PID)]: $(Message)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-k</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Time</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ge</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='ivar'>@start</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-k</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Message</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>S</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>deny</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-k</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Sender</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>kernel</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-o</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-k</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Time</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ge</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='ivar'>@start</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-k</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Message</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>S</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>deny</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-k</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Sender</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sandboxd</span><span class='tstring_end'>&quot;</span></span>
    <span class='rbracket'>]</span>
    <span class='id identifier rubyid_logs'>logs</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Utils.html" title="Utils (module)">Utils</a></span></span><span class='period'>.</span><span class='id identifier rubyid_popen_read'><span class='object_link'><a href="Utils.html#popen_read-class_method" title="Utils.popen_read (method)">popen_read</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>syslog</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_syslog_args'>syslog_args</span><span class='rparen'>)</span>

    <span class='comment'># These messages are confusing and non-fatal, so don&#39;t report them.
</span>    <span class='id identifier rubyid_logs'>logs</span> <span class='op'>=</span> <span class='id identifier rubyid_logs'>logs</span><span class='period'>.</span><span class='id identifier rubyid_lines'>lines</span><span class='period'>.</span><span class='id identifier rubyid_grep_v'>grep_v</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^.*Python\(\d+\) deny file-write.*pyc$</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span>

    <span class='kw'>unless</span> <span class='id identifier rubyid_logs'>logs</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='kw'>if</span> <span class='ivar'>@logfile</span>
        <span class='const'><span class='object_link'><a href="File.html" title="File (class)">File</a></span></span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='ivar'>@logfile</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>w</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_log'>log</span><span class='op'>|</span>
          <span class='id identifier rubyid_log'>log</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_logs'>logs</span>
          <span class='id identifier rubyid_log'>log</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\nWe use time to filter sandbox log. Therefore, unrelated logs may be recorded.\n</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='kw'>if</span> <span class='ivar'>@failed</span> <span class='op'>&amp;&amp;</span> <span class='const'><span class='object_link'><a href="Homebrew.html" title="Homebrew (module)">Homebrew</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Homebrew/EnvConfig.html" title="Homebrew::EnvConfig (module)">EnvConfig</a></span></span><span class='period'>.</span><span class='id identifier rubyid_verbose?'><span class='object_link'><a href="Homebrew.html#verbose%3F-class_method" title="Homebrew.verbose? (method)">verbose?</a></span></span>
        <span class='id identifier rubyid_ohai'>ohai</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Sandbox Log</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_logs'>logs</span>
        <span class='gvar'>$stdout</span><span class='period'>.</span><span class='id identifier rubyid_flush'>flush</span> <span class='comment'># without it, brew test-bot would fail to catch the log
</span>      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="record_log-instance_method">
  
    #<strong>record_log</strong>(file)  &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  This method may only be used in the <a href="https://github.com/Homebrew/brew">Homebrew/brew</a> repository.
  Third parties should avoid using this method if possible, as it may be removed or changed without warning.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sandbox.rb', line 26</span>

<span class='kw'>def</span> <span class='id identifier rubyid_record_log'>record_log</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
  <span class='ivar'>@logfile</span> <span class='op'>=</span> <span class='id identifier rubyid_file'>file</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
     Generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>.
</div>

    </div>
  </body>
</html>